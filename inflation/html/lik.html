<!doctype html>
<head>
    <style type="text/css">
        .select-selected {
        width:200px;
        }
    </style>
    <style type="text/css">
        .chartBox {
            width:900px;
        }
    </style>

</head>
<body>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0"></script>
	<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datasource@0.1.0"></script>
    <div class="select-selected">
        <select id=year>
            <option value="2022">2022</option>
            <option value="2021">2021</option>
        </select>
    </div>
    <div class="chartBox">
		<canvas id="pieChartLIK"></canvas>
	</div>
    <script>
        const baseURL = 'https://127.0.0.1/storage_json_inflation'

        var color = Chart.helpers.color;
        const data = {
                    datasets: [{
                        backgroundColor: [
                            "rgb(57,80,203)",
                            "rgb(172,99,84)",
                            "rgb(152,47,171)",
                            "rgb(240,63,241)",
                            "rgb(170,24,112)",
                            "rgb(226,177,83)",
                            "rgb(187,56,20)",
                            "rgb(40,86,118)",
                            "rgb(67,208,49)",
                            "rgb(33,23,152)",
                            "rgb(217,153,237)",
                            "rgb(184,219,236)"
                        ],
                        hoverOffset: 4
                    }]
        };
        var configValue = {
            type: 'pie',
            data: data,
            plugins: [ChartDataSource],
            options: {
                title: {
                    display: true,
                    text: 'LIK Weights'
                },
                plugins: {
                        datasource: {
                            type: 'json',
                            url: baseURL + '/weights_2022.json',
                            rowMapping: 'dataset',
                            indexLabels: 'labels',
                            data: 'datasets[*].data'
                        }
                    }
                }

        };

       var ctxLIKPie = document.getElementById('pieChartLIK').getContext('2d');
       pieChartLIK = new Chart(ctxLIKPie, configValue);

        const year = document.getElementById('year');
        year.addEventListener('change', updateYear);
        function updateYear() {
            const label = year.options[year.selectedIndex].text;
            console.log("updateYear() called" , label)
            pieChartLIK.options.plugins.datasource.url = baseURL +'/weights_' + label +'.json';
            pieChartLIK.update()
        }
    </script>
</body>
</html>
